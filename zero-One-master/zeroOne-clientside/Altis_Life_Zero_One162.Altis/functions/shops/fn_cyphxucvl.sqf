private['_lAG','_GEWE','_lpEH','_jiBU','_PdK','_qZe','_lQm','_Pgg','_GGwj','_kNi'];_lQm = param[0,false,[false]];_GEWE = (findDisplay 3100) displayCtrl 3102;_lpEH = lbCurSel ((findDisplay 3100) displayCtrl 3108);_jiBU = lbCurSel _GEWE;if(_jiBU isEqualTo -1) exitWith { titleRsc ["RGB","PLAIN"]; _qZe = (((uiNamespace getVariable "aWaQ") displayCtrl 5501) ctrlSetText localize "STR_Shop_NoClothes");};_lAG = (_GEWE lbValue _jiBU);_PdK = (_GEWE lbData _jiBU);_GGwj = false;_Pgg = (group player) getVariable["HNCqyH",[]];if(_lQm) then { if(_Pgg isEqualTo []) exitWith { titleRsc ["introtext","PLAIN"]; _qZe = (((uiNamespace getVariable "nok_introdisplay") displayCtrl 5501) ctrlSetText "Du bist in keiner Gang!"); _GGwj = true; }; if((_Pgg select 5) < (_lAG * _lpEH)) then { titleRsc ["introtext","PLAIN"]; _qZe = (((uiNamespace getVariable "nok_introdisplay") displayCtrl 5501) ctrlSetText localize "STR_Shop_NotEnoughClothesGang"); _GGwj = true; };}else{ if((_lAG * _lpEH) > ([3, 0] call zero_fnc_JNHrfnI)) then { titleRsc ["introtext","PLAIN"]; _qZe = (((uiNamespace getVariable "nok_introdisplay") displayCtrl 5501) ctrlSetText localize "STR_Shop_NotEnoughClothes"); _GGwj = true;};};if(_GGwj) exitWith {};if(_PdK in ["ItemWatch","ItemMap","ItemGPS","ItemCompass","ToolKit","FirstAidKit","Binocular","NVGoggles","NVGoggles_INDEP","NVGoggles_OPFOR","Medikit","Rangefinder","B_UavTerminal"]) then { if(!(player canAdd _PdK)) exitWith {_GGwj = true};};if(_GGwj) exitWith {hint localize "STR_NOTF_NoRoom"};for "_i" from 1 to _lpEH do { if(_lQm) then { if((_Pgg select 5) < _lAG) then { titleRsc ["RGB","PLAIN"];_qZe = (((uiNamespace getVariable "aWaQ") displayCtrl 5501) ctrlSetText localize "STR_Shop_NotEnoughClothesGang"); _GGwj = true; }else{ _Pgg set[5,(_Pgg select 5) - _lAG]; ((group player) setVariable["HNCqyH",_Pgg,true]); if(isNil "rAKL") then { rAKL = true; [(_lAG * _lpEH),_Pgg select 1] spawn { [format ["GANG BUY: %1 (%3) hat fuer %2 Euro eingekauft.", player getVariable["aOsyc",name player], [_this select 0] call zero_fnc_nAnP, _this select 1],"zo_log",false,false] call zero_fnc_fdEkiHoij; _kNi = serverTime + 10; waitUntil {isNull (findDisplay 3100) || (servertime >= _kNi)}; _Pgg = (group player) getVariable ["HNCqyH",[]]; hc_updateGang = [clientOwner,1,[_Pgg select 0,_Pgg select 5]]; HC1_owner publicVariableClient "hc_updateGang"; hc_updateGang = nil; rAKL = nil; }; }; }; }else{ if(_lAG > ([3, 0] call zero_fnc_JNHrfnI)) then { titleRsc ["RGB","PLAIN"];_qZe = (((uiNamespace getVariable "aWaQ") displayCtrl 5501) ctrlSetText localize "STR_Shop_NotEnoughClothes"); _GGwj = true; }else{ [1, ([3, 0] call zero_fnc_JNHrfnI) - _lAG] call zero_fnc_JNHrfnI; }; }; if(_GGwj) exitWith {}; [_PdK,true] call zero_fnc_wykNbUNp;};playSound "WeaponRestedOn";[[_GEWE,_jiBU]] call zero_fnc_QZL;