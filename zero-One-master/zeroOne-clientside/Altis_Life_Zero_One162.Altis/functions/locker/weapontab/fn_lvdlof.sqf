private ['_hXLX','_Mos','_cKK','_gMhi','_PdK','_JDn','_UaO','_nQon','_UqNU','_NGS','_mSiY','_vvm','_wAk','_lwkK'];disableSerialization;_hXLX = param[0,[],[[]]];_Mos = param[1,"",[""]];_cKK = (_hXLX param[0,controlNull,[controlNull]]);_gMhi = (_hXLX param[3,0,[0]]);_PdK = (_hXLX param[4,[],[[]]]);_PdK = _PdK select 0;_JDn = toLower(_PdK select 2);if(_JDn isEqualTo "") exitWith {};_UaO = toLower(_cKK lbData 0);_nQon = switch (_Mos) do { case "silencer": {101}; case "optic": {201}; case "pointer": {301}; case "bipod": {302}; default {-1};};if((getNumber(configfile >> "CfgWeapons" >> _JDn >> "ItemInfo" >> "type")) != _nQon || _gMhi != 1612) exitWith {hint "Das passt hier nicht"};if(_gMhi isEqualTo 1612) then {  _UqNU = toLower(((findDisplay 1000) displayCtrl 1613) lbData 0);  if(isClass (configFile >> "CfgWeapons" >> _UqNU >> "WeaponSlotsInfo")) then { _NGS = getArray(configFile >> "CfgWeapons" >> _UqNU >> "WeaponSlotsInfo" >> "PointerSlot" >> "compatibleItems"); _mSiY = getArray(configFile >> "CfgWeapons" >> _UqNU >> "WeaponSlotsInfo" >> "CowsSlot" >> "compatibleItems"); _vvm = getArray(configFile >> "CfgWeapons" >> _UqNU >> "WeaponSlotsInfo" >> "MuzzleSlot" >> "compatibleItems"); _wAk = getArray(configFile >> "CfgWeapons" >> _UqNU >> "WeaponSlotsInfo" >> "UnderBarrelSlot" >> "compatibleItems"); _lwkK = []; {_lwkK set [_forEachIndex, toLower(_x)];} forEach (_NGS + _mSiY + _vvm + _wAk); if(!(_JDn in (_lwkK))) exitWith {hint "Das kannst du nicht an die Waffen anbringen"}; lbClear _cKK; _cKK lbAdd format [" %1",getText (configFile >> "CfgWeapons" >> _JDn >> "displayName")]; _cKK lbSetTooltip [lbSize(_cKK) - 1, getText (configFile >> "CfgWeapons" >> _JDn >> "displayName")]; _cKK lbSetPicture [lbSize(_cKK) - 1, getText (configFile >> "CfgWeapons" >> _JDn >> "picture")]; _cKK lbSetValue [lbSize(_cKK) - 1, 1]; _cKK lbSetData [lbSize(_cKK) - 1, _JDn]; [toLower(_JDn),-1] call zero_fnc_ludDvGtx; if(!(_UaO isEqualTo "")) then { [toLower(_UaO),1] call zero_fnc_ludDvGtx; }; player addHandgunItem _JDn; };}else{ _gMhi = ((findDisplay 1000) displayCtrl _gMhi); lbClear _gMhi; _defaultPic = switch (getNumber(configfile >> "CfgWeapons" >> _JDn >> "ItemInfo" >> "type")) do { case 101:{"\A3\Ui_f\data\GUI\Rsc\RscDisplayGear\ui_gear_muzzle_gs.paa"}; case 201:{"\A3\Ui_f\data\GUI\Rsc\RscDisplayGear\ui_gear_top_gs.paa"}; case 301:{"\A3\Ui_f\data\GUI\Rsc\RscDisplayGear\ui_gear_side_gs.paa"}; case 302:{"\A3\Ui_f\data\GUI\Rsc\RscDisplayGear\ui_gear_bipod_gs.paa"}; default{""}; }; _gMhi lbAdd ""; _gMhi lbSetPicture [lbSize(_gMhi) - 1,_defaultPic]; [toLower(_JDn),1] call zero_fnc_ludDvGtx; player removeHandgunItem _JDn;};[] call zero_fnc_mHYaO;_cKK lbSetCurSel -1;