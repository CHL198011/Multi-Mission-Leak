private ['_MKCN','_LVA','_PdK','_eeV','_yybh','_ytG','_heb','_XVNt','_FmDy','_lpeS','_WmUn','_eFt'];disableSerialization;_MKCN = param[0,controlNull,[controlNull]];_LVA = param[3,0,[0]];_PdK = param[4,[],[[]]];_PdK = _PdK select 0;_eeV = toLower(_PdK select 2);if(_eeV isEqualTo "") exitWith {};if(ctrlIDC _MKCN == 1619 && (!(isClass(configfile >> "CfgMagazines" >> _eeV)))) exitWith {hint "Das passt hier nicht"};if(ctrlIDC _MKCN == 1618 && (_LVA != 1619)) exitWith {hint "Das passt hier nicht"};_yybh = (CtjFPq select 3);_ytG = (findDisplay 1000) getVariable "yCDCO";if(_LVA isEqualTo 1618) then {  _lpeS = parseNumber(ctrlText((findDisplay 1000) displayCtrl 1620)); if(_lpeS isEqualTo 0) exitWith {}; _heb = [toLower(_eeV),_yybh] call zero_fnc_oKzQhZKu; if(_heb isEqualTo -1) exitWith {}; _XVNt = _yybh select _heb; if((_XVNt select 1) < _lpeS) exitWith {hint "So viele Magazine hast du nicht";}; if(!(player canAdd [_eeV,_lpeS])) exitWith {hint "So viele Magazine kannst du nicht tragen";}; if((_XVNt select 1) isEqualTo _lpeS) then { _yybh deleteAt _heb; }else{ _yybh set[_heb,[toLower(_XVNt select 0), (_XVNt select 1) - _lpeS]]; }; _heb = [toLower(_eeV),_ytG] call zero_fnc_oKzQhZKu; if((_heb isEqualTo -1)) then { _ytG pushBack [toLower(_eeV),_lpeS]; }else{ _XVNt = _ytG select _heb; _ytG set[_heb,[toLower(_XVNt select 0), (_XVNt select 1) + _lpeS]]; }; player addMagazines[_eeV,_lpeS];}else{ _lpeS = parseNumber(ctrlText((findDisplay 1000) displayCtrl 1621)); if(_lpeS isEqualTo 0) exitWith {}; _heb = [toLower(_eeV),_ytG] call zero_fnc_oKzQhZKu; if(_heb isEqualTo -1) exitWith {}; _XVNt = _ytG select _heb; if((_XVNt select 1) < _lpeS) exitWith {hint "So viele Magazine hast du nicht";}; if((_XVNt select 1) isEqualTo _lpeS) then { _ytG deleteAt _heb; player removeMagazines _eeV; }else{ _ytG set[_heb,[toLower(_XVNt select 0), (_XVNt select 1) - _lpeS]]; for "_i" from 1 to _lpeS step 1 do {player removeMagazine _eeV;}; }; [toLower(_eeV),_lpeS] call zero_fnc_ludDvGtx;};CtjFPq set[3,_yybh];(findDisplay 1000) setVariable["yCDCO",_ytG];_WmUn = (findDisplay 1000) displayCtrl 1618;_eFt = (findDisplay 1000) displayCtrl 1619;lbClear _WmUn;lbClear _eFt;{ _FmDy = toLower(_x select 0); if (_FmDy != "") then { if(isClass(configFile >> "CfgMagazines" >> _FmDy)) then { _WmUn lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _FmDy >> "displayName")]; _WmUn lbSetTooltip [lbSize(_WmUn) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _FmDy >> "displayName")]]; _WmUn lbSetPicture [lbSize(_WmUn) - 1, getText (configFile >> "CfgMagazines" >> _FmDy >> "picture")]; _WmUn lbSetValue [lbSize(_WmUn) - 1, (_x select 1)]; _WmUn lbSetData [lbSize(_WmUn) - 1, _FmDy]; }; };} forEach _yybh;{ _FmDy = _x select 0; if(isClass(configFile >> "CfgMagazines" >> _FmDy)) then { _eFt lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _FmDy >> "displayName")]; _eFt lbSetTooltip [lbSize(_eFt) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _FmDy >> "displayName")]]; _eFt lbSetPicture [lbSize(_eFt) - 1, getText (configFile >> "CfgMagazines" >> _FmDy >> "picture")]; _eFt lbSetValue [lbSize(_eFt) - 1, (_x select 1)]; _eFt lbSetData [lbSize(_eFt) - 1, _FmDy]; };} forEach _ytG;if((lbSize(_WmUn) - 1) isEqualTo -1) then {_WmUn lbAdd "Keine Magazine verfügbar";};if((lbSize(_eFt) - 1) isEqualTo -1) then {_eFt lbAdd "Keine Magazine verfügbar";};_WmUn lbSetCurSel -1;_eFt lbSetCurSel -1;lbSort _WmUn;lbSort _eFt;