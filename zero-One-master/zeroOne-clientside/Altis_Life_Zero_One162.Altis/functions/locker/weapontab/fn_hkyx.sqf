private ['_kTg','_kMZ','_eeV','_aQIi','_HNIq','_EBR','_GFG','_FmDy','_zetT','_GSrf'];disableSerialization;_kTg = param[0,controlNull,[controlNull]];_kMZ = lbCurSel _kTg;_eeV = _kTg lbData _kMZ;if(_eeV isEqualTo "") exitWith {};_aQIi = (CtjFPq select 3);_HNIq = (findDisplay 1000) getVariable "yCDCO";if((ctrlIDC _kTg) isEqualTo 1618) then {  _EBR = parseNumber(ctrlText((findDisplay 1000) displayCtrl 1620)); if(_EBR isEqualTo 0) exitWith {}; _kMZ = [toLower(_eeV),_aQIi] call zero_fnc_oKzQhZKu; if(_kMZ isEqualTo -1) exitWith {}; _GFG = _aQIi select _kMZ; if((_GFG select 1) < _EBR) exitWith {hint "So viele Magazine hast du nicht";}; if(!(player canAdd [_eeV,_EBR])) exitWith {hint "So viele Magazine kannst du nicht tragen";}; if((_GFG select 1) isEqualTo _EBR) then { _aQIi deleteAt _kMZ; }else{ _aQIi set[_kMZ,[toLower(_GFG select 0), (_GFG select 1) - _EBR]]; }; _kMZ = [toLower(_eeV),_HNIq] call zero_fnc_oKzQhZKu; if((_kMZ isEqualTo -1)) then { _HNIq pushBack [toLower(_eeV),_EBR]; }else{ _GFG = _HNIq select _kMZ; _HNIq set[_kMZ,[toLower(_GFG select 0), (_GFG select 1) + _EBR]]; }; player addMagazines[_eeV,_EBR];}else{ _EBR = parseNumber(ctrlText((findDisplay 1000) displayCtrl 1621)); if(_EBR isEqualTo 0) exitWith {}; _kMZ = [toLower(_eeV),_HNIq] call zero_fnc_oKzQhZKu; if(_kMZ isEqualTo -1) exitWith {}; _GFG = _HNIq select _kMZ; if((_GFG select 1) < _EBR) exitWith {hint "So viele Magazine hast du nicht";}; if((_GFG select 1) isEqualTo _EBR) then { _HNIq deleteAt _kMZ; player removeMagazines _eeV; }else{ _HNIq set[_kMZ,[toLower(_GFG select 0), (_GFG select 1) - _EBR]]; for "_i" from 1 to _EBR do {player removeMagazine _eeV;}; }; [toLower(_eeV),_EBR] call zero_fnc_ludDvGtx;};CtjFPq set[3,_aQIi];(findDisplay 1000) setVariable["yCDCO",_HNIq];_zetT = (findDisplay 1000) displayCtrl 1618;_GSrf = (findDisplay 1000) displayCtrl 1619;lbClear _zetT;lbClear _GSrf;{ _FmDy = toLower(_x select 0); if (_FmDy != "") then { if(isClass(configFile >> "CfgMagazines" >> _FmDy)) then { _zetT lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _FmDy >> "displayName")]; _zetT lbSetTooltip [lbSize(_zetT) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _FmDy >> "displayName")]]; _zetT lbSetPicture [lbSize(_zetT) - 1, getText (configFile >> "CfgMagazines" >> _FmDy >> "picture")]; _zetT lbSetValue [lbSize(_zetT) - 1, (_x select 1)]; _zetT lbSetData [lbSize(_zetT) - 1, _FmDy]; }; };} forEach _aQIi;{ _FmDy = _x select 0; if(isClass(configFile >> "CfgMagazines" >> _FmDy)) then { _GSrf lbAdd format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _FmDy >> "displayName")]; _GSrf lbSetTooltip [lbSize(_GSrf) - 1, format ["%2 (%1)", (_x select 1), getText (configFile >> "CfgMagazines" >> _FmDy >> "displayName")]]; _GSrf lbSetPicture [lbSize(_GSrf) - 1, getText (configFile >> "CfgMagazines" >> _FmDy >> "picture")]; _GSrf lbSetValue [lbSize(_GSrf) - 1, (_x select 1)]; _GSrf lbSetData [lbSize(_GSrf) - 1, _FmDy]; };} forEach _HNIq;if((lbSize(_zetT) - 1) isEqualTo -1) then {_zetT lbAdd "Keine Magazine verfügbar";};if((lbSize(_GSrf) - 1) isEqualTo -1) then {_GSrf lbAdd "Keine Magazine verfügbar";};_zetT lbSetCurSel -1;_GSrf lbSetCurSel -1;lbSort _zetT;lbSort _GSrf;