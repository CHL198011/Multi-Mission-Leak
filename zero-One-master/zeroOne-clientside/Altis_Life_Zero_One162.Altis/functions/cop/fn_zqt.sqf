private['_ScW','_qUNP','_Vpb','_KYbZ','_jgzP','_VJc','_kMp','_slk'];if((player getVariable ["GHdlZHW",false])) exitWith { openMap [false, false]; [] spawn { uisleep 0.5; openMap [false, false]; }; hint localize "STR_NOTF_zero_var_restrainedNoMap";};_ScW = [];_qUNP = "";_KYbZ = [];_Vpb = "";uisleep 0.3;if(visibleMap) then { { if(!(_x getVariable["GHdlZHW",false]) && (alive _x) && !(_x in _KYbZ)) then { _slk = vehicle _x; if(_slk != _x && {!(_slk isKindOf "ParachuteBase")}) then { _jgzP = count(crew _slk); { if(alive _x && _x != (driver _slk) && _x in units(group player) && !(_x in _KYbZ)) then { _Vpb = _Vpb + format ["%1%2", _x getVariable["aOsyc",name _x], if(_forEachIndex == _jgzP-1) then {""} else {", "}]; _KYbZ pushBack _x; }; } forEach (crew _slk); _qUNP = format["[%1]%2 %3",getText(configFile>>"CfgVehicles">>typeOf _slk>>"DisplayName"), if(!isNull (driver _slk) && {((driver _slk) in units(group player))} && {!((driver _slk) in _KYbZ)} ) then { _KYbZ pushBack (driver _slk); format["%1 %2%3",if((driver _slk) getVariable ["ZbrguZt",""] isEqualTo "") then {""}else{"[" + ((driver _slk) getVariable "ZbrguZt") + "]"}, (driver _slk) getVariable["aOsyc",name _x], if(_Vpb isEqualTo "") then {""}else{","}] }else{""}, _Vpb]; _Vpb = ""; }else{ _qUNP = format["%1 %2",if(_x getVariable ["ZbrguZt",""] isEqualTo "") then {""}else{"[" + (_x getVariable "ZbrguZt") + "]"},_x getVariable["aOsyc",name _x]]; }; _VJc = createMarkerLocal [format["%1_marker",_x],visiblePosition _x]; _VJc setMarkerColorLocal "ColorBlue"; _VJc setMarkerTypeLocal "Mil_dot"; _VJc setMarkerTextLocal format["%1", _qUNP]; _ScW pushBack [_VJc,_x]; _qUNP = ""; }; } foreach units(group player); while {visibleMap} do { { _VJc = _x select 0; _kMp = _x select 1; if(!isNil "_kMp") then { if(!isNull _kMp) then { _VJc setMarkerPosLocal (visiblePosition _kMp); }; }; } foreach _ScW; if(!visibleMap) exitWith {}; uisleep 0.02; }; {deleteMarkerLocal (_x select 0);} foreach _ScW; _ScW = []; _KYbZ = [];};