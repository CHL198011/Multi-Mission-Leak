private['_qZe','_EEX','_qUNP','_ryS','_MPom','_nALz','_GGwj','_GlE','_Pgg','_ZueC','_mYmj','_iATT','_gUiy','_OeXY','_fjL','_VqP'];disableserialization;createdialog "MDdjNKKV";_qZe = findDisplay 3200;if (isNull _qZe) exitwith {};_GlE = (group player);_Pgg = _GlE getVariable ["HNCqyH",[]];if(count _Pgg < 7) exitWith {hint "Es ist ein Fehler aufgetreten"};if(typeName (_Pgg select(count _Pgg -1)) == "BOOL") exitWith {hint "Nicht für temporäre Gangs verfügbar!";};if(_GlE getVariable["ZxnX",false]) exitWith {hint "Auf die Namensänderung wird bereits zugegriffen!"};_GlE setVariable["ZxnX",true,true];_EEX = _qZe displayCtrl 3202;_qUNP = _qZe displayCtrl 3201;_ryS = _qZe displayCtrl 3204;_MPom = _qZe displayCtrl 3203;_MPom ctrlsettext "Überprüfen";_MPom buttonSetAction "jDAY = true;";_OeXY = _qZe displayCtrl 3205;_OeXY ctrlSetText "Abbrechen";_EEX ctrlSetStructuredText parseText format["<t align='center' size='1'>Bitte gib den gewünschten Gangtag ein.</t>"];_ryS ctrlSetStructuredText parseText format["<t align='center' size='1'>Es sind nur <br/> Buchstaben, Zahlen, Leerzeichen und beschränkte Sonderzeichen erlaubt!</t>"];_GGwj = false;_ZueC = "";while {true} do { _nALz = nil; jDAY = false; _qUNP ctrlSetText ""; _ZueC = ""; waituntil {jDAY or isNull (findDisplay 3200)}; jDAY = nil; if (isNull (findDisplay 3200)) exitwith {_GGwj = true;}; _ZueC = ctrlText _qUNP; if (_ZueC isequalto "") then { _nALz = true; _ryS ctrlSetStructuredText parseText format["<t align='center' size='1' color='#DC143C'>Das Eingabefeld ist leer.</t>"]; }else { if ((count _ZueC) > 5) then { _nALz = true; _ryS ctrlSetStructuredText parseText format["<t align='center' size='1' color='#DC143C'>Der Gangtag ist länger als 5 Zeichen</t>"]; }else{ _fjL = toArray (_ZueC); _VqP = toArray("!#$%&()*+,-./0123456789<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]_abcdefghijklmnopqrstuvwxyz{|} "); { if !(_x in _VqP) exitwith { _nALz = true; _ryS ctrlSetStructuredText parseText format["<t align='center' size='1' color='#DC143C'>Das Zeichen %1 ist im Gangtag nicht erlaubt!</t>",tostring [_x]]; } }foreach _fjL; }; }; if (isnil "_nALz") then { _ryS ctrlSetStructuredText parseText format["<t align='center' size='1' color='#EDF5F5'>Der Gangtag %1 wird überprüft!</t>",_ZueC]; hc_checkGangname = [clientOwner,1,_ZueC]; HC1_owner publicVariableClient "hc_checkGangname"; hc_checkGangname = nil; waituntil {!isnil "IGC"}; if (IGC isEqualTo []) then { _ryS ctrlSetStructuredText parseText format["<t align='center' size='1' color='#0BDA51'>Der Gangtag %1 ist noch frei!</t>",_ZueC]; } else { _nALz = true; _ryS ctrlSetStructuredText parseText format["<t align='center' size='1' color='#DC143C'>Der Gangtag %1 ist bereits belegt!</t>",_ZueC]; }; IGC = nil; }; if (isnil "_nALz") exitwith{};};if(_GGwj) exitWith {closeDialog 0;_GlE setVariable["ZxnX",nil,true];};_mYmj = [ parseText format["Möchtest du %1€ für das Ändern des Gangtags in <t color='#ffff00'>%2</t> bezahlen?",[5000000] call zero_fnc_nAnP,_ZueC], "Gangtag ändern", localize "STR_Global_Yes", localize "STR_Global_No"] call BIS_fnc_guiMessage;if(!_mYmj) exitWith {closeDialog 0;_GlE setVariable["ZxnX",nil,true];};_gUiy = _Pgg select 5;if(_gUiy < 5000000) exitWith {hint format["Du hast nicht genug Geld auf dem Gangkonto. Es fehlen dir %1",[5000000 - _gUiy] call zero_fnc_nAnP]; closeDialog 0};_Pgg set[5,_gUiy - 5000000];hc_updateGang = [clientOwner,7,[_Pgg select 0,_ZueC,_Pgg select 5]];HC1_owner publicVariableClient "hc_updateGang";hc_updateGang = nil;_Pgg set[7,_ZueC];_GlE setVariable["HNCqyH",_Pgg,true];_GlE setVariable["ZxnX",nil,true];closeDialog 0;[] spawn zero_fnc_tdzoG;