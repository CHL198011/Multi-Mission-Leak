private['_lpJb','_qUNP','_avd','_KYOr','_TGj','_VJc','_kMp','_slk'];if((player getVariable ["GHdlZHW",false])) exitWith { openMap [false, false]; [] spawn { uisleep 0.5; openMap [false, false]; }; hint localize "STR_NOTF_restrainedNoMap";};_lpJb = [];_qUNP = "";_avd = [];_KYOr = "";uisleep 0.3;if(visibleMap) then { { if(!(_x getVariable["GHdlZHW",false]) && (alive _x) && !(_x in _avd)) then { _slk = vehicle _x; if(_slk != _x && {!(_slk isKindOf "ParachuteBase")}) then { _TGj = count(crew _slk); { if(alive _x && _x != driver _slk && _x in units(group player)) then { _KYOr = _KYOr + format ["%1%2", _x getVariable["aOsyc",name _x], if(_forEachIndex == _TGj-1) then {""} else {", "}]; _avd pushBack _x; }; } forEach (crew _slk); _qUNP = format["[%1] %2 %3",getText(configFile>>"CfgVehicles">>typeOf _slk>>"DisplayName"), if(!isNull (driver _slk) && {(driver _slk in units(group player))}) then { if(_TGj == 1) then { format["%1",(driver _slk) getVariable["aOsyc",name _x]] }else{ format["%1%2",(driver _slk) getVariable["aOsyc",name _x], ","] }; }else{""}, _KYOr]; _KYOr = ""; }else{ _qUNP = _x getVariable["aOsyc",name _x]; }; _VJc = createMarkerLocal [format["%1_marker",_x],visiblePosition _x]; _VJc setMarkerColorLocal "ColorYellow"; _VJc setMarkerTypeLocal "Mil_dot"; _VJc setMarkerTextLocal format["%1", _qUNP]; _lpJb pushBack [_VJc,_x]; }; } foreach units(group player); while {visibleMap} do { { _VJc = _x select 0; _kMp = _x select 1; if(!isNil "_kMp" && !isNull _kMp) then { _VJc setMarkerPosLocal (visiblePosition _kMp); }; } foreach _lpJb; if(!visibleMap) exitWith {}; uisleep 0.02; }; {deleteMarkerLocal (_x select 0);} foreach _lpJb; _lpJb = []; _avd = [];};