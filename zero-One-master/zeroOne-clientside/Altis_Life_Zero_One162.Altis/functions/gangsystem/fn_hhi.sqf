private['_qZe','_lzdL','_qUNP','_drdT','_LQMv','_nALz','_GGwj','_GlE','_Pgg','_Tqiz','_mYmj','_iATT','_eZbd','_diCk','_fjL','_dKd'];disableserialization;createdialog "MDdjNKKV";_qZe = findDisplay 3200;if (isNull _qZe) exitwith {};_GlE = (group player);_Pgg = _GlE getVariable ["HNCqyH",[]];if(count _Pgg < 7) exitWith {hint "Es ist ein Fehler aufgetreten"};if(typeName (_Pgg select(count _Pgg -1)) == "BOOL") exitWith {hint "Nicht für temporäre Gangs verfügbar!";};uiSleep random(0.5);if(_GlE getVariable["ZxnX",false]) exitWith {hint "Auf die Namensänderung wird bereits zugegriffen!"};_GlE setVariable["ZxnX",true,true];_qUNP = _qZe displayCtrl 3201;_lzdL = _qZe displayCtrl 3202;_LQMv = _qZe displayCtrl 3203;_LQMv ctrlsettext "Überprüfen";_LQMv buttonSetAction "jDAY = true;";_drdT = _qZe displayCtrl 3204;_diCk = _qZe displayCtrl 3205;_diCk ctrlSetText "Abbrechen";_lzdL ctrlSetStructuredText parseText format["<t align='center' size='1'>Bitte gib den gewünschten Gangnamen ein.</t>"];_drdT ctrlSetStructuredText parseText format["<t align='center' size='1'>Es sind nur <br/> Buchstaben, Zahlen, Leerzeichen und beschränkte Sonderzeichen erlaubt!</t>"];_GGwj = false;_Tqiz = "";while {true} do { _nALz = nil; jDAY = false; _qUNP ctrlSetText ""; _Tqiz = ""; waituntil {jDAY or isNull (findDisplay 3200)}; jDAY = nil; if (isNull (findDisplay 3200)) exitwith {_GGwj = true;}; _Tqiz = ctrlText _qUNP; if (_Tqiz isequalto "") then { _nALz = true; _drdT ctrlSetStructuredText parseText format["<t align='center' size='1' color='#DC143C'>Das Eingabefeld ist leer.</t>"]; }else { if ((count _Tqiz) > 24) then { _nALz = true; _drdT ctrlSetStructuredText parseText format["<t align='center' size='1' color='#DC143C'>Der Gangname ist länger als 24 Zeichen</t>"]; }else{ _fjL = toArray (_Tqiz); _dKd = toArray("!#$%&()*+,-./0123456789<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]_abcdefghijklmnopqrstuvwxyz{|} "); { if !(_x in _dKd) exitwith { _nALz = true; _drdT ctrlSetStructuredText parseText format["<t align='center' size='1' color='#DC143C'>Das Zeichen %1 ist im Gangnamen nicht erlaubt!</t>",tostring [_x]]; } }foreach _fjL; }; }; if (isnil "_nALz") then { _drdT ctrlSetStructuredText parseText format["<t align='center' size='1' color='#EDF5F5'>Der Gangname %1 wird überprüft!</t>",_Tqiz]; hc_checkGangname = [clientOwner,0,_Tqiz]; HC1_owner publicVariableClient "hc_checkGangname"; hc_checkGangname = nil; waituntil {!isnil "IGC"}; if (IGC isEqualTo []) then { _drdT ctrlSetStructuredText parseText format["<t align='center' size='1' color='#0BDA51'>Der Gangname %1 ist noch frei!</t>",_Tqiz]; } else { _nALz = true; _drdT ctrlSetStructuredText parseText format["<t align='center' size='1' color='#DC143C'>Der Gangname %1 ist bereits belegt!</t>",_Tqiz]; }; IGC = nil; }; if (isnil "_nALz") exitwith{};};if(_GGwj) exitWith {closeDialog 0;_GlE setVariable["ZxnX",nil,true];};_mYmj = [ parseText format["Möchtest du %1€ für das Ändern des Gangnamens in <t color='#ffff00'>%2</t> bezahlen?",[10000000] call zero_fnc_nAnP,_Tqiz], "Gangname ändern", localize "STR_Global_Yes", localize "STR_Global_No"] call BIS_fnc_guiMessage;if(!_mYmj) exitWith {_GlE setVariable["ZxnX",nil,true];};_eZbd = _Pgg select 5;if(_eZbd < 10000000) exitWith {hint format["Du hast nicht genug Geld auf dem Gangkonto. Es fehlen dir %1",[10000000 - _eZbd] call zero_fnc_nAnP]; closeDialog 0};_Pgg set[5,_eZbd - 10000000];hc_updateGang = [clientOwner,2,[_Pgg select 0,_Tqiz,_Pgg select 5]];HC1_owner publicVariableClient "hc_updateGang";hc_updateGang = nil;_Pgg set[1,_Tqiz];_GlE setVariable["HNCqyH",_Pgg,true];_GlE setVariable["ZxnX",nil,true];closeDialog 0;[] spawn zero_fnc_tdzoG;