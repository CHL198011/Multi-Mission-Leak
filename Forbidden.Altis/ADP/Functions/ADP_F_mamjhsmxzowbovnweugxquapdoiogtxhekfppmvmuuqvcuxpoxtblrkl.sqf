
#include<macro.h>
private ["_vlfwudnbepowbgqupamztdbbdwbihvtunbvptievdmcancknnswdivsvnyvoxduhlzww","_search","_hheoubsztbpspducqegweydzgyvovukjnhnzpdcmlusfgkkkdhkprgkwaiadfqrqsh","_jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt","_wqvhosrdwrndhdjjhdxuxoynitjauqdrkevvfhmzxxdgmelsftutfrgsreesj","_nrgccbhriozwgjmlrpbfrikonhmmuzbrtrnalfhoettgmgqcfpnqbcbtzkasftnhzs","_wxcrgjmrlyyoqvnecrxrhgxhcjuqzteshwlktdtmcaqkcotxxulcvqwqwchgmpttiqex","_wmjdtjqnwveinbntblayccbwddldtmaafykikhhswsljajyddbnfbofamslfizmmmutml"]; if(isNil "kanSpecMode") then {kanSpecMode = false}; if(isNil "kanSpecCount") then {kanSpecCount = 0}; if(isNil "kanSpecSearch") then {kanSpecSearch = ""}; if(isNil "kanSpecCurrent") then {kanSpecCurrent = objNull}; if(isNil "kanSpecMap") then {kanSpecMap = false}; kanSpecActivity = diag_tickTime;  _vlfwudnbepowbgqupamztdbbdwbihvtunbvptievdmcancknnswdivsvnyvoxduhlzww = { 	private ["_wxcrgjmrlyyoqvnecrxrhgxhcjuqzteshwlktdtmcaqkcotxxulcvqwqwchgmpttiqex","_mrzyxhaoyurpoqgphhgolgqbedzsuzfmyeuinzribgyscviwznylsoedumocvafrseg","_search","_jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt","_inbdnvjvnmkigaogiiujmujrcrhnpibcmivuxumnjkrubigbrpzpeiaholifabjpelxr","_mfsagycxilstbwusaydpjjfkzdxiitequyrrmhpuslfixsvxfkgssvnynyecrfipyceyb","_wmjdtjqnwveinbntblayccbwddldtmaafykikhhswsljajyddbnfbofamslfizmmmutml","_omzknceaufodzvkcgkgyczdyajugmtzjnjxcbtzigqnplykvrqlbuebpkivtoeulvlqms"]; 	_jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt = _this select 0; 	_search = _this select 1; 	_wxcrgjmrlyyoqvnecrxrhgxhcjuqzteshwlktdtmcaqkcotxxulcvqwqwchgmpttiqex = _this select 2; 	_wmjdtjqnwveinbntblayccbwddldtmaafykikhhswsljajyddbnfbofamslfizmmmutml = _this select 3; 	 	{(_hheoubsztbpspducqegweydzgyvovukjnhnzpdcmlusfgkkkdhkprgkwaiadfqrqsh displayCtrl _x) ctrlEnable false} foreach [1871,1872,1873,1874]; 	 	if((call life_adminlevel) >= 1) then { 		_omzknceaufodzvkcgkgyczdyajugmtzjnjxcbtzigqnplykvrqlbuebpkivtoeulvlqms = playableUnits; 	} else { 		_omzknceaufodzvkcgkgyczdyajugmtzjnjxcbtzigqnplykvrqlbuebpkivtoeulvlqms = []; 		if((call life_reblevel) >= 6) then {_omzknceaufodzvkcgkgyczdyajugmtzjnjxcbtzigqnplykvrqlbuebpkivtoeulvlqms = _omzknceaufodzvkcgkgyczdyajugmtzjnjxcbtzigqnplykvrqlbuebpkivtoeulvlqms + ([true] call life_fnc_dukkaashsaqxerftxqvfbicuzddjsictjwmgmzyzuqckdtaeivdmgnmyneod)}; 		 		{ 			switch (true) do { 				case ((call life_copleveltotal) >= 7 && (side _x) == west && (_x getVariable ["rank",0]) > 0 && !(_x getVariable ["safekeeping",false])): {_omzknceaufodzvkcgkgyczdyajugmtzjnjxcbtzigqnplykvrqlbuebpkivtoeulvlqms pushBack _x}; 				case ((call life_medicLeveltotal) >= 4 && (side _x) == independent && !(_x getVariable ["safekeeping",false])): {_omzknceaufodzvkcgkgyczdyajugmtzjnjxcbtzigqnplykvrqlbuebpkivtoeulvlqms pushBack _x}; 			}; 		} foreach playableUnits; 	}; 	 	_inbdnvjvnmkigaogiiujmujrcrhnpibcmivuxumnjkrubigbrpzpeiaholifabjpelxr = 0; 	{ 		if(_wxcrgjmrlyyoqvnecrxrhgxhcjuqzteshwlktdtmcaqkcotxxulcvqwqwchgmpttiqex != kanSpecCount) exitWith {}; 		_mrzyxhaoyurpoqgphhgolgqbedzsuzfmyeuinzribgyscviwznylsoedumocvafrseg = name _x; 		 		if(_search == "" OR ([_search,_mrzyxhaoyurpoqgphhgolgqbedzsuzfmyeuinzribgyscviwznylsoedumocvafrseg,1,false] call TON_fnc_rizooueqiujrzomxvqjrvxtfracppjrckttqkukvwwticyrsdkwhimpaeao)) then { 			_jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt lbAdd format ["%1",_mrzyxhaoyurpoqgphhgolgqbedzsuzfmyeuinzribgyscviwznylsoedumocvafrseg]; 			_jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt lbSetData [_inbdnvjvnmkigaogiiujmujrcrhnpibcmivuxumnjkrubigbrpzpeiaholifabjpelxr,str _x]; 			if(_search == "" && _x == kanSpecCurrent) then {[nil,_x,_wmjdtjqnwveinbntblayccbwddldtmaafykikhhswsljajyddbnfbofamslfizmmmutml] spawn ADP_fnc_bascqyunfhtyggxixryvmcqimzvfhhnwevcuvkrapgfwezcgbf;}; 			_inbdnvjvnmkigaogiiujmujrcrhnpibcmivuxumnjkrubigbrpzpeiaholifabjpelxr = _inbdnvjvnmkigaogiiujmujrcrhnpibcmivuxumnjkrubigbrpzpeiaholifabjpelxr + 1; 		}; 	} foreach _omzknceaufodzvkcgkgyczdyajugmtzjnjxcbtzigqnplykvrqlbuebpkivtoeulvlqms;  	lbSort _jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt; };   _search = [_this,0,false,[false]] call BIS_fnc_param; _wmjdtjqnwveinbntblayccbwddldtmaafykikhhswsljajyddbnfbofamslfizmmmutml = [_this,1,false,[false]] call BIS_fnc_param;  if(!(isNull (findDisplay 7500)) && !_search) exitWith {}; if(!life_isAlive) exitWith {};  disableSerialization; if(!_search) then { 	createDialog "kanSpecModeFrame"; 	waitUntil {!isNull (findDisplay 7500)}; };  if(isNull (findDisplay 7500)) exitWith {}; _hheoubsztbpspducqegweydzgyvovukjnhnzpdcmlusfgkkkdhkprgkwaiadfqrqsh = findDisplay 7500; _jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt = _hheoubsztbpspducqegweydzgyvovukjnhnzpdcmlusfgkkkdhkprgkwaiadfqrqsh displayCtrl 7055; _wqvhosrdwrndhdjjhdxuxoynitjauqdrkevvfhmzxxdgmelsftutfrgsreesj = _hheoubsztbpspducqegweydzgyvovukjnhnzpdcmlusfgkkkdhkprgkwaiadfqrqsh displayCtrl 7081; _nrgccbhriozwgjmlrpbfrikonhmmuzbrtrnalfhoettgmgqcfpnqbcbtzkasftnhzs = _hheoubsztbpspducqegweydzgyvovukjnhnzpdcmlusfgkkkdhkprgkwaiadfqrqsh displayCtrl 7080; _nrgccbhriozwgjmlrpbfrikonhmmuzbrtrnalfhoettgmgqcfpnqbcbtzkasftnhzs ctrlSetText format["%1:",(localize "STR_m_Search")];  kanSpecCount = kanSpecCount + 1; _wxcrgjmrlyyoqvnecrxrhgxhcjuqzteshwlktdtmcaqkcotxxulcvqwqwchgmpttiqex = kanSpecCount; kanSpecMode = true;   if(_search) exitWith { 	lbClear _jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt; 	_search = ctrlText _wqvhosrdwrndhdjjhdxuxoynitjauqdrkevvfhmzxxdgmelsftutfrgsreesj; 	kanSpecSearch = _search; 	[_jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt,_search,_wxcrgjmrlyyoqvnecrxrhgxhcjuqzteshwlktdtmcaqkcotxxulcvqwqwchgmpttiqex,false] call _vlfwudnbepowbgqupamztdbbdwbihvtunbvptievdmcancknnswdivsvnyvoxduhlzww; };  player setPosATL [8586.22,25111.7,0.00205231]; waitUntil {!safekeeping_inprogress}; if(!safekeeping_active OR safe_gearset != "admin") then {[false,"admin",player,false,4] spawn life_fnc_lwragbrbljopxfxnuapcrijyceobizsliszunxpqimtqztdqvagubxyu;}; if(!invisible) then { 	[false] spawn ADP_fnc_invisibility; }; if(!life_debugging) then {player hideObject true;}; ["kanSpecModeID", "onMapSingleClick", "[0,_pos] spawn ADP_fnc_mozxymgnbkufknrshvfxwukxorgydlvvswzrwuhtrmktesnmeeqvzugbvzf;"] call BIS_fnc_addStackedEventHandler;  [_jxyxknzwmawihbkihdhaufhcldjccocracktavgagfgxhzjjxbstmyulozkt,"",_wxcrgjmrlyyoqvnecrxrhgxhcjuqzteshwlktdtmcaqkcotxxulcvqwqwchgmpttiqex,_wmjdtjqnwveinbntblayccbwddldtmaafykikhhswsljajyddbnfbofamslfizmmmutml] call _vlfwudnbepowbgqupamztdbbdwbihvtunbvptievdmcancknnswdivsvnyvoxduhlzww; 	 _hheoubsztbpspducqegweydzgyvovukjnhnzpdcmlusfgkkkdhkprgkwaiadfqrqsh displayAddEventHandler ["KeyDown", { 	if((_this select 1) == 14) then {  		((findDisplay 7500) displayCtrl 7055) lbSetCurSel -1; 		[true] spawn ADP_fnc_mamjhsmxzowbovnweugxquapdoiogtxhekfppmvmuuqvcuxpoxtblrkl; 	}; }];  if(isNil "kanSpecRewardsLoop") then { 	kanSpecRewardsLoop = true; 	[] spawn { 		private ["_fmxsrcozbxfqfucxanyqjolkfjnilhsumuyznxypcvimwymhjclepynfbnmewtypivzlre"]; 		_fmxsrcozbxfqfucxanyqjolkfjnilhsumuyznxypcvimwymhjclepynfbnmewtypivzlre = 0; 		 		while {true} do { 			if(kanSpecMode) then { 				_fmxsrcozbxfqfucxanyqjolkfjnilhsumuyznxypcvimwymhjclepynfbnmewtypivzlre = _fmxsrcozbxfqfucxanyqjolkfjnilhsumuyznxypcvimwymhjclepynfbnmewtypivzlre + 1; 				if(_fmxsrcozbxfqfucxanyqjolkfjnilhsumuyznxypcvimwymhjclepynfbnmewtypivzlre % 60 == 0 && (diag_tickTime - kanSpecActivity) < 240) then { 					_reward = [150,12000]; 					 					[_reward select 0,0] spawn life_fnc_earnXP; 					life_atmbank = life_atmbank + (_reward select 1); 					[1] spawn SOCK_fnc_ddjmbrftntgdwpptfaoymlxkcjyscjwhklmcfylqhrqrxtxznnh; 					systemChat format[localize "STR_m_SpectateReward",round ((_reward select 0) * life_xpMultiplier),[(_reward select 1)] call life_fnc_ccxpkhrsgzfibqpgmuxgqovtqnwczbibnrrxqvyckzrmhckzyugqq]; 				}; 			} else { 				_fmxsrcozbxfqfucxanyqjolkfjnilhsumuyznxypcvimwymhjclepynfbnmewtypivzlre = 0; 			}; 			 			sleep 1; 		}; 	}; };  waitUntil {isNull (findDisplay 7500) && !kanSpecMap}; if((call life_adminlevel) == 0) then {player allowDamage false;}; kanSpecMode = false; player hideObject false;  if(life_debugging) then {systemChat (str (attachedTo player))}; if!(isNull (attachedTo player)) then {if(life_debugging) then {systemChat "deeetach"}; detach player;}; if(life_debugging) then {systemChat "waiting"}; waitUntil {isNull (attachedTo player)}; if(life_debugging) then {systemChat "detached"};   if!(isNil "kanSpecExitWithTp") then { 	if(life_debugging) then {systemChat "exit with tp"}; 	sleep 0.2; 	if(vehicle kanSpecCurrent != kanSpecCurrent) then { 		if!(player moveInAny (vehicle kanSpecCurrent)) then { 			player setPosASL (getPosASL kanSpecCurrent); 		}; 	} else { 		if(surfaceIsWater (getPos kanSpecCurrent)) then { 			player setPosASL (getPosASL kanSpecCurrent); 		} else { 			player setPosATL (getPosATL kanSpecCurrent); 		}; 	}; } else { 	player setPosATL [8586.22,25111.7,0.00205231]; }; kanSpecExitWithTp = nil;  [4,(getPlayerUID player),"","Kannels spec mode","Disabled",profileName,"",str (getPos player)] remoteExec ["TON_fnc_cqbslmzhelexdchvshruhtirwniyhyywbybxhiltsdxdujmnhjuhnal",2]; ["kanSpecModeID", "onMapSingleClick"] call BIS_fnc_RemoveStackedEventHandler; player switchCamera 'EXTERNAL'; ["",0,-0.36,500,0.2,0,1800] spawn BIS_fnc_dynamicText; ["",0,-0.30,500,0.2,0,1801] spawn BIS_fnc_dynamicText;  if((call life_adminlevel) == 0) then { 	[] spawn life_fnc_ahlahrugiqknetuumakyonsqyothaelchcsczkdkarivhpuegwjdsgr; 	LeftEventGearVar = true; 	if(invisible) then {[] spawn ADP_fnc_invisibility;}; }; 