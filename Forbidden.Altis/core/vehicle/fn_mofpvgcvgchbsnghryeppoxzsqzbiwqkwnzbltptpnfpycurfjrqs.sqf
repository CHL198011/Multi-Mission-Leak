 private["_vehicle","_pxoguhbgopkbtlnyjbpnlcjsiydrllwaodoqmnjhstyzmpvgcxdvzbshmcrgZones","_zone","_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj","_item","_gscpptzvciztyzhamzgankyrjzjmukslbcqnkarkdfcacgynscipukzadmpguglrdd","_qjygndvnlnvgqegjakoxignfmcenqrohmaqssakgdmogejveqyidbpyvjkxoebwcrugwmz","_udfbbeznklliyejymokidjavautiktdumgawuhqtymzxemfmjsgegstepxwtj"]; _vehicle = [_this,0,ObjNull,[ObjNull]] call BIS_fnc_param; if(isNull _vehicle) exitWith {};  if(!isNil {_vehicle getVariable "mining"}) exitWith {hint localize "STR_NOTF_DeviceIsMining";};  closeDialog 0;  life_action_inUse = true;  _tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj = [_vehicle] call life_fnc_tldmxiaaawydcyvjenfxuvhodcmhglobclxfeodxzgjxwashxcijp; if((_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj select 1) >= (_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj select 0)) exitWith {hint localize "STR_NOTF_DeviceFull"; life_action_inUse = false;}; _pxoguhbgopkbtlnyjbpnlcjsiydrllwaodoqmnjhstyzmpvgcxdvzbshmcrgZones = ["apple_1","apple_2","apple_3","apple_4","peaches_1","peaches_2","peaches_3","peaches_4","heroin_1","cocaine_1","weed_1","lead_1","iron_1","salt_1","sand_1","diamond_1","oil_1","oil_2","rock_1","hydrogenchloride_1","causticsoda_1","myriaticacid_1"]; _zone = "";   { 	if(player distance (getMarkerPos _x) < 150) exitWith {_zone = _x;}; } foreach _pxoguhbgopkbtlnyjbpnlcjsiydrllwaodoqmnjhstyzmpvgcxdvzbshmcrgZones;  if(_zone == "") exitWith { 	hint localize "STR_NOTF_notNearResource"; 	life_action_inUse = false; };   _item = switch(true) do { 	case (_zone in ["apple_1","apple_2","apple_3","apple_4"]): {["apple",60]}; 	case (_zone in ["peaches_1","peaches_2","peaches_3","peaches_4"]): {["peach",60]}; 	case (_zone in ["heroin_1"]): {["heroin_unprocessed",15]}; 	case (_zone in ["cocaine_1"]): {["cocaine_unprocessed",15]}; 	case (_zone in ["weed_1"]): {["cannabis",20]}; 	case (_zone in ["lead_1"]): {["copper_unrefined",15]}; 	case (_zone in ["kanel_1"]): {["kanel",20]}; 	case (_zone in ["iron_1"]): {["iron_unrefined",15]}; 	case (_zone in ["salt_1"]): {["salt_unrefined",20]}; 	case (_zone in ["sand_1"]): {["sand",20]}; 	case (_zone in ["diamond_1"]): {["diamond_uncut",20]}; 	case (_zone in ["oil_1","oil_2"]): {["oil_unprocessed",15]}; 	case (_zone in ["rock_1"]): {["rock",15]}; 	case (_zone in ["hydrogenchloride_1"]): {["hydrogenchloride",20]}; 	case (_zone in ["causticsoda_1"]): {["causticsoda",20]}; 	case (_zone in ["myriaticacid_1"]): {["myriaticacid",20]}; 	default {""}; };  _udfbbeznklliyejymokidjavautiktdumgawuhqtymzxemfmjsgegstepxwtj = _item select 1; _item = _item select 0;  if(_item == "") exitWith {hint "Bad Resource?"; life_action_inUse = false;}; _vehicle setVariable ["mining",true,true];  [_vehicle,"life_fnc_znpeydqqygenhohxmhstxkesxszozkokvzrhnlyjsrqlsixvvo",true,false] call life_fnc_MP;   life_action_inUse = false;   while {true} do { 	if(!alive _vehicle OR isNull _vehicle) exitWith {}; 	if(isEngineOn _vehicle) exitWith {titleText[localize "STR_NOTF_MiningStopped","PLAIN"];}; 	titleText[localize "STR_NOTF_DeviceMining","PLAIN"]; 	_time = time + 27; 	 	 	waitUntil { 		if(isEngineOn _vehicle) exitWith {titleText[localize "STR_NOTF_MiningStopped","PLAIN"]; true}; 		if(round(_time - time) < 1) exitWith {true}; 		sleep 0.2; 		false 	}; 	if(isEngineOn _vehicle) exitWith {titleText[localize "STR_NOTF_MiningStopped","PLAIN"];}; 	_gscpptzvciztyzhamzgankyrjzjmukslbcqnkarkdfcacgynscipukzadmpguglrdd = _vehicle getVariable ["Trunk",[[],0]]; 	_items = _gscpptzvciztyzhamzgankyrjzjmukslbcqnkarkdfcacgynscipukzadmpguglrdd select 0; 	_space = _gscpptzvciztyzhamzgankyrjzjmukslbcqnkarkdfcacgynscipukzadmpguglrdd select 1; 	_qjygndvnlnvgqegjakoxignfmcenqrohmaqssakgdmogejveqyidbpyvjkxoebwcrugwmz = [_item,_items] call TON_fnc_index; 	_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj = [_vehicle] call life_fnc_tldmxiaaawydcyvjenfxuvhodcmhglobclxfeodxzgjxwashxcijp; 	_sum = [_item,_udfbbeznklliyejymokidjavautiktdumgawuhqtymzxemfmjsgegstepxwtj,_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj select 1,_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj select 0] call life_fnc_wvdznvaqxsfdfvikfnyhkpoigxucyfqjhqtuchxgawxyvlxhru;  	if(_sum < 1) exitWith {titleText[localize "STR_NOTF_DeviceFull","PLAIN"];}; 	_itemWeight = ([_item] call life_fnc_ixqubeuqyvvlxqyldjgxzumawmrijapytyxfcsaswdetlfqsdciynug) * _sum; 	if(_qjygndvnlnvgqegjakoxignfmcenqrohmaqssakgdmogejveqyidbpyvjkxoebwcrugwmz == -1) then { 		_items pushBack [_item,_sum]; 	} else { 		_val = _items select _qjygndvnlnvgqegjakoxignfmcenqrohmaqssakgdmogejveqyidbpyvjkxoebwcrugwmz select 1; 		_items set[_qjygndvnlnvgqegjakoxignfmcenqrohmaqssakgdmogejveqyidbpyvjkxoebwcrugwmz,[_item,_val + _sum]]; 	}; 	 	if(fuel _vehicle == 0) exitWith {titleText[localize "STR_NOTF_OutOfFuel","PLAIN"];}; 	 	 	if(local _vehicle) then { 		_vehicle setFuel (fuel _vehicle)-0.02; 	} else { 		[[_vehicle,(fuel _vehicle)-0.02],"life_fnc_setFuel",_vehicle,false] call life_fnc_MP; 	}; 	 	if(fuel _vehicle == 0) exitWith {titleText[localize "STR_NOTF_OutOfFuel","PLAIN"];}; 	titleText[format[localize "STR_NOTF_DeviceMined",_sum],"PLAIN"]; 	_vehicle setVariable["Trunk",[_items,_space + _itemWeight],true]; 	_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj = [_vehicle] call life_fnc_tldmxiaaawydcyvjenfxuvhodcmhglobclxfeodxzgjxwashxcijp; 	_sum = [_item,_udfbbeznklliyejymokidjavautiktdumgawuhqtymzxemfmjsgegstepxwtj,_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj select 1,_tyscfjcglxpvzhzngynepncczestaxgbjbpzmlkvjinyhralgtdmivvlrqrvxnrj select 0] call life_fnc_wvdznvaqxsfdfvikfnyhkpoigxucyfqjhqtuchxgawxyvlxhru;  	if(_sum < 1) exitWith {titleText[localize "STR_NOTF_DeviceFull","PLAIN"];}; 	sleep 2; };  _vehicle setVariable["mining",nil,true]; 