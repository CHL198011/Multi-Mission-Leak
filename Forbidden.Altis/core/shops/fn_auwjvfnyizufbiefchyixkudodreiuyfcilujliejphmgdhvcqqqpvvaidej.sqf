
#include <macro.h>
 private["_wmscrupzfmuttgfqkrgxjcpdnabzvnssdijwcgkqlvjnynniqyxubmfmsuxvtp","_ruxngahstslahgehfoxnvywijugxyqlnqfoocipiirqowrwrmyuqqsmujbbg","_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy","_vxakxicjpbdamtmfqxuqhnowmisppbeztypqnlclanpfgzyfgmzillfpgbcaro","_pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse","_yexzkualyrubwzdhqsrkegqsbhvowkjmnfbzjykyurnixobrbqespyorrwqlk","_famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw","_koysitvmptfywujtinocpikfqzebwpnsxgoicnsajppfovsyycqpggofdpxuqxin","_vehicle","_yqaqjnrzzclgrttmdezhtctoqwfmsqnftxbqbbirihdksnrtdlkhbdpphhhq","_kbtgdxzwezgqquyybbnzjbvpbbesgzixvtsrjszqefutccqkhkbsvwinnbcvuhu","_ehuhyvpppkerylesjojocpesvfxmngfaooraepjbikwrszfkmvjptinmvfenbuqftup","_qrfoqtaqwdwlkcsaqvddhzphaozsfadcsahkkujjflufxcnwsjaybkwgdgwzzjyrs","_rzmltejnsjszckkgejdgncbdfhmeycqzlszzpedkelzaxtyqlglxiwsuvrjl","_rtuvhhkiqzkhnatuwuferhijcerrpqmulsgkouprahuqalhbkdwgepwikwuawtm"]; _wmscrupzfmuttgfqkrgxjcpdnabzvnssdijwcgkqlvjnynniqyxubmfmsuxvtp = SEL(_this,0); if((lbCurSel 2302) == -1) exitWith {hint localize "STR_Shop_Veh_DidntPick"};  _vIndex = lbValue[2302,(lbCurSel 2302)];  _rzmltejnsjszckkgejdgncbdfhmeycqzlszzpedkelzaxtyqlglxiwsuvrjl = call compile (lbData[2302,(lbCurSel 2302)]); _ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy = _rzmltejnsjszckkgejdgncbdfhmeycqzlszzpedkelzaxtyqlglxiwsuvrjl select 0; _pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse = _rzmltejnsjszckkgejdgncbdfhmeycqzlszzpedkelzaxtyqlglxiwsuvrjl select 1; _kbtgdxzwezgqquyybbnzjbvpbbesgzixvtsrjszqefutccqkhkbsvwinnbcvuhu = _rzmltejnsjszckkgejdgncbdfhmeycqzlszzpedkelzaxtyqlglxiwsuvrjl select 2; _vxakxicjpbdamtmfqxuqhnowmisppbeztypqnlclanpfgzyfgmzillfpgbcaro = false;  _vehicleList = M_CONFIG(getArray,"CarShops",SEL(life_veh_shop,0),"vehicles"); _yqaqjnrzzclgrttmdezhtctoqwfmsqnftxbqbbirihdksnrtdlkhbdpphhhq = M_CONFIG(getText,"CarShops",SEL(life_veh_shop,0),"side");    if(_wmscrupzfmuttgfqkrgxjcpdnabzvnssdijwcgkqlvjnynniqyxubmfmsuxvtp) then {_pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse = round(_pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse * 1.5)}; _yexzkualyrubwzdhqsrkegqsbhvowkjmnfbzjykyurnixobrbqespyorrwqlk = lbValue[2304,(lbCurSel 2304)];  if(_yexzkualyrubwzdhqsrkegqsbhvowkjmnfbzjykyurnixobrbqespyorrwqlk == 16 && _ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "B_Heli_Light_01_F" && (call life_donatorlvl) < 3) exitWith {hint format[localize "STR_m_ColorReqDonor",3];}; if(_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "C_Offroad_01_repair_F" && perk_17 < 2) exitWith {hint format[localize "STR_m_MustHavePerk",localize ([17] call life_fnc_qokbfvuujyauzhpwhhtwfwakspbzosfzvnzazblmmcrbpdqwwbfdbdztgoic)];};     if(_pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse < 0) exitWith {};  if(CASH < _pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse) exitWith {hint format[localize "STR_Shop_Veh_NotEnough",[_pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse - CASH] call life_fnc_ccxpkhrsgzfibqpgmuxgqovtqnwczbibnrrxqvyckzrmhckzyugqq];};   if(_kbtgdxzwezgqquyybbnzjbvpbbesgzixvtsrjszqefutccqkhkbsvwinnbcvuhu in ["pilot","mAir","cAir"] && perk_0 < 2) exitWith {hint localize "STR_m_NoPerkAir";}; if(_kbtgdxzwezgqquyybbnzjbvpbbesgzixvtsrjszqefutccqkhkbsvwinnbcvuhu in ["pilot","mAir","cAir"]) then {_kbtgdxzwezgqquyybbnzjbvpbbesgzixvtsrjszqefutccqkhkbsvwinnbcvuhu = "";}; if(!(EQUAL(_kbtgdxzwezgqquyybbnzjbvpbbesgzixvtsrjszqefutccqkhkbsvwinnbcvuhu,"")) && {!(LICENSE_VALUE(_kbtgdxzwezgqquyybbnzjbvpbbesgzixvtsrjszqefutccqkhkbsvwinnbcvuhu,_yqaqjnrzzclgrttmdezhtctoqwfmsqnftxbqbbirihdksnrtdlkhbdpphhhq))} && !(SEL(life_veh_shop,0) == "civ_ship" && playerSide == independent)) exitWith {hint localize "STR_Shop_Veh_NoLicense"};  if(playerSide == west && perk_26 < 5 && _ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "B_UAV_01_F") exitWith {hint format[localize 'STR_m_NeedPerkForDrones',localize ([26] call life_fnc_qokbfvuujyauzhpwhhtwfwakspbzosfzvnzazblmmcrbpdqwwbfdbdztgoic)]};  _ruxngahstslahgehfoxnvywijugxyqlnqfoocipiirqowrwrmyuqqsmujbbg = SEL(life_veh_shop,1); _famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw = "";  if((SEL(life_veh_shop,0) == "med_air_hs")) then { 	if(count(nearestObjects[(getMarkerPos _ruxngahstslahgehfoxnvywijugxyqlnqfoocipiirqowrwrmyuqqsmujbbg),["Air"],35]) == 0) exitWith {_famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw = _ruxngahstslahgehfoxnvywijugxyqlnqfoocipiirqowrwrmyuqqsmujbbg}; } else { 	 	if(EQUAL(typeName _ruxngahstslahgehfoxnvywijugxyqlnqfoocipiirqowrwrmyuqqsmujbbg,typeName [])) then { 		 		{if(count(nearestObjects[(getMarkerPos _x),["Car","Ship","Air"],5]) == 0) exitWith {_famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw = _x};} foreach _ruxngahstslahgehfoxnvywijugxyqlnqfoocipiirqowrwrmyuqqsmujbbg; 	} else { 		if(count(nearestObjects[(getMarkerPos _ruxngahstslahgehfoxnvywijugxyqlnqfoocipiirqowrwrmyuqqsmujbbg),["Car","Ship","Air"],5]) == 0) exitWith {_famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw = _ruxngahstslahgehfoxnvywijugxyqlnqfoocipiirqowrwrmyuqqsmujbbg}; 	}; };  _rtuvhhkiqzkhnatuwuferhijcerrpqmulsgkouprahuqalhbkdwgepwikwuawtm = false; if(playerside == civilian && (call life_rebactive) == 0) then { 	if(((_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "B_MRAP_01_F") && (perk_32 == 1)) OR ((_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "B_Heli_Transport_01_F") && (perk_31 == 1))) then { 		_rtuvhhkiqzkhnatuwuferhijcerrpqmulsgkouprahuqalhbkdwgepwikwuawtm = true; 		if!(isNull (var_base getVariable [format["%1_%2",_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy,getPlayerUID player],objNull])) then { 			_vxakxicjpbdamtmfqxuqhnowmisppbeztypqnlclanpfgzyfgmzillfpgbcaro = true; 			[1,localize "STR_m_VehicleAlreadyExists"] spawn life_fnc_broadcast; 		}; 	}; }; if(_vxakxicjpbdamtmfqxuqhnowmisppbeztypqnlclanpfgzyfgmzillfpgbcaro) exitWith {};  if(EQUAL(_famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw,"")) exitWith {hint localize "STR_Shop_Veh_Block";}; SUB(CASH,_pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse); hint format[localize "STR_Shop_Veh_Bought",getText(configFile >> "CfgVehicles" >> _ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy >> "displayName"),[_pamzrtifxhonldcxdeihnvjvrifulztenastgtrqjwpapkfqgomjzuhvwkptqse] call life_fnc_ccxpkhrsgzfibqpgmuxgqovtqnwczbibnrrxqvyckzrmhckzyugqq];  _koysitvmptfywujtinocpikfqzebwpnsxgoicnsajppfovsyycqpggofdpxuqxin = if(_famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw == "car_g_v7") then {[0,0,0]} else {getMarkerPos _famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw};   if((life_veh_shop select 0) == "med_air_hs") then { 	if(_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "B_UAV_01_F") then { 		_vehicle = ([[0,0,999], 0, "B_UAV_01_F", west] call BIS_fnc_spawnVehicle) select 0; 	} else { 		_vehicle = createVehicle [_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy,[0,0,999],[], 0, "NONE"]; 	}; 	waitUntil {!isNil "_vehicle"};  	_vehicle allowDamage false; 	_hs = nearestObjects[getMarkerPos _famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw,["Land_Hospital_side2_F"],50] select 0; 	_vehicle setPosATL (_hs modelToWorld [-0.4,-4,12.65]); 	_vehicle lock 2; 	[[_vehicle,_yexzkualyrubwzdhqsrkegqsbhvowkjmnfbzjykyurnixobrbqespyorrwqlk],"life_fnc_jrbqnfqnsmxhqydcdsemnaljzqmxavnlrbynrmmicrsgbgtkanttdqeqnzhv",true,false] call life_fnc_MP; 	[_vehicle] call life_fnc_vlfyyyqnbtyyafnmnifyaadfykplbdcgkayjwxdrcakuwyksbqh; 	[[_vehicle,"trunk_in_use",false,true],"TON_fnc_sjswuvcnmkeqqwthksfpbsnttefmmewunokopbxecrbonmbjmnnfcyzbhq",false,false] call life_fnc_MP; 	[[_vehicle,"vehicle_info_owners",[[getPlayerUID player,profileName]],true],"TON_fnc_sjswuvcnmkeqqwthksfpbsnttefmmewunokopbxecrbonmbjmnnfcyzbhq",false,false] call life_fnc_MP; 	_vehicle disableTIEquipment true;  } else { 	if(_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "B_UAV_01_F") then { 		_vehicle = ([_koysitvmptfywujtinocpikfqzebwpnsxgoicnsajppfovsyycqpggofdpxuqxin, 0, "B_UAV_01_F", west] call BIS_fnc_spawnVehicle) select 0; 	} else { 		_vehicle = createVehicle [_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy, _koysitvmptfywujtinocpikfqzebwpnsxgoicnsajppfovsyycqpggofdpxuqxin, [], 0, "NONE"]; 	}; 	waitUntil {!isNil "_vehicle"};  	_vehicle allowDamage false;  	_vehicle lock 2; 	_vehicle setVectorUp (surfaceNormal (getMarkerPos _famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw)); 	_vehicle setDir (markerDir _famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw); 	if(_famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw == "car_g_v7") then { 		_vehicle setPosATL [(getMarkerPos _famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw) select 0,(getMarkerPos _famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw) select 1,3.422]; 	} else { 		_vehicle setPos (getMarkerPos _famjspusxjapwvnxyhdlqgzwtynygkhesrpfhnnulsafgybiiyubgguyuassypliw); 	}; 	[[_vehicle,_yexzkualyrubwzdhqsrkegqsbhvowkjmnfbzjykyurnixobrbqespyorrwqlk],"life_fnc_jrbqnfqnsmxhqydcdsemnaljzqmxavnlrbynrmmicrsgbgtkanttdqeqnzhv",true,false] call life_fnc_MP; 	[_vehicle] call life_fnc_vlfyyyqnbtyyafnmnifyaadfykplbdcgkayjwxdrcakuwyksbqh; 	[[_vehicle,"trunk_in_use",false,true],"TON_fnc_sjswuvcnmkeqqwthksfpbsnttefmmewunokopbxecrbonmbjmnnfcyzbhq",false,false] call life_fnc_MP; 	[[_vehicle,"vehicle_info_owners",[[getPlayerUID player,profileName]],true],"TON_fnc_sjswuvcnmkeqqwthksfpbsnttefmmewunokopbxecrbonmbjmnnfcyzbhq",false,false] call life_fnc_MP; 	_vehicle disableTIEquipment true;  };   switch(playerSide) do { 	case west: { 		[_vehicle,"cop_offroad",true] spawn life_fnc_gsjymhoudxcmlaovukarxbvzvyfvgpilkqglhyqqtbzaxyjabojgqwag; 	}; 	 	case civilian: { 		if(EQUAL(SEL(life_veh_shop,2),"civ") && {_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "B_Heli_Light_01_F"}) then { 			[_vehicle,"civ_littlebird",true] spawn life_fnc_gsjymhoudxcmlaovukarxbvzvyfvgpilkqglhyqqtbzaxyjabojgqwag; 		}; 	}; 	 	case independent: { 		[_vehicle,"med_offroad",true] spawn life_fnc_gsjymhoudxcmlaovukarxbvzvyfvgpilkqglhyqqtbzaxyjabojgqwag; 	}; };  if(_rtuvhhkiqzkhnatuwuferhijcerrpqmulsgkouprahuqalhbkdwgepwikwuawtm) then { 	var_base setVariable [format["%1_%2",_ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy,getPlayerUID player],_vehicle,true]; };  _vehicle allowDamage true;  _vehicle setVariable["1available",true,true]; _vehicle setVariable["2available",true,true]; _vehicle setVariable["3available",true,true]; _vehicle setVariable["3available",true,true]; _vehicle setVariable["4available",true,true]; _vehicle setVariable["5available",true,true]; _vehicle setVariable["6available",true,true]; _vehicle setVariable["7available",true,true]; _vehicle setVariable["8available",true,true]; _vehicle setVariable["9available",true,true]; _vehicle setVariable["10available",true,true];  _vehicle setVariable["owner_perk20",perk_20,true];  _vehicle setVariable["color",_yexzkualyrubwzdhqsrkegqsbhvowkjmnfbzjykyurnixobrbqespyorrwqlk,true]; _vehicle setVariable["ownerSide",playerSide,true];    if((_vehicle isKindOf "I_Heli_Transport_02_F") OR (_vehicle isKindOf "B_Heli_Transport_01_F") OR (_vehicle isKindOf "B_MRAP_01_F") OR (_vehicle isKindOf "O_MRAP_02_F")) then { 	_vehicle setVariable["doorPhase",0,true]; } else { 	_vehicle setVariable["doorPhase",2,true]; };   life_vehicles pushBack _vehicle; [[getPlayerUID player,playerSide,_vehicle,1],"TON_fnc_hsbiadiddcvaycjrpmszfoddsriioyibcdglfyqlfxvxazonyvmxwdhov",false,false] call life_fnc_MP;  _ehuhyvpppkerylesjojocpesvfxmngfaooraepjbikwrszfkmvjptinmvfenbuqftup = getText(configFile >> "CfgVehicles" >> (typeOf _vehicle) >> "displayName"); if((typeOf _vehicle) == "O_T_VTOL_02_infantry_F") then {_ehuhyvpppkerylesjojocpesvfxmngfaooraepjbikwrszfkmvjptinmvfenbuqftup = "Y-32 Xian (Infantry Transport)";}; if((typeOf _vehicle) == "O_T_VTOL_02_vehicle_F") then {_ehuhyvpppkerylesjojocpesvfxmngfaooraepjbikwrszfkmvjptinmvfenbuqftup = "Y-32 Xian (Vehicle Transport)";};  if(_wmscrupzfmuttgfqkrgxjcpdnabzvnssdijwcgkqlvjnynniqyxubmfmsuxvtp) then { 	[[(getPlayerUID player),playerSide,_vehicle,_yexzkualyrubwzdhqsrkegqsbhvowkjmnfbzjykyurnixobrbqespyorrwqlk],"TON_fnc_vehicleCreate",false,false] call life_fnc_MP; 	[1,(getPlayerUID player),"","Bought vehicle",_ehuhyvpppkerylesjojocpesvfxmngfaooraepjbikwrszfkmvjptinmvfenbuqftup,profileName,"",str (getPos player)] remoteExec ["TON_fnc_cqbslmzhelexdchvshruhtirwniyhyywbybxhiltsdxdujmnhjuhnal",2]; } else { 	[1,(getPlayerUID player),"","Rented vehicle",_ehuhyvpppkerylesjojocpesvfxmngfaooraepjbikwrszfkmvjptinmvfenbuqftup,profileName,"",str (getPos player)] remoteExec ["TON_fnc_cqbslmzhelexdchvshruhtirwniyhyywbybxhiltsdxdujmnhjuhnal",2]; };  [_vehicle,player] remoteExec ["TON_fnc_jnyjlbmjvzwrjmehlvpekzggjysjtuqrlxwipjbnpdrtgrdbkwhddcmd",2];  [0] call SOCK_fnc_ddjmbrftntgdwpptfaoymlxkcjyscjwhklmcfylqhrqrxtxznnh; closeDialog 0;   if(_yexzkualyrubwzdhqsrkegqsbhvowkjmnfbzjykyurnixobrbqespyorrwqlk == 16 && _ijrvhqrjkwiwbcaxzvirpnbhbsdyopktnzdcgabnzawbncljrjkfjfwmoxzy == "B_Heli_Light_01_F") then {hint localize "STR_m_BoughtPinkHeli";};  _qrfoqtaqwdwlkcsaqvddhzphaozsfadcsahkkujjflufxcnwsjaybkwgdgwzzjyrs = typeOf _vehicle in ["O_G_Van_01_fuel_F","C_Van_01_fuel_F","B_G_Van_01_fuel_F","I_G_Van_01_fuel_F","B_Truck_01_fuel_F","B_T_Truck_01_fuel_F","I_Truck_02_fuel_F","O_Truck_02_fuel_F","C_Truck_02_fuel_F","O_Heli_Transport_04_fuel_F","O_Truck_03_fuel_F"]; if(_qrfoqtaqwdwlkcsaqvddhzphaozsfadcsahkkujjflufxcnwsjaybkwgdgwzzjyrs) then {_vehicle setFuel 0.2;};  _vehicle setFuelCargo 0; [_vehicle,120,player] remoteExec ["TON_fnc_blcjojlnehozczqhmecgaibilkbzvzilervagdlgiacasbhcmpqhed",2]; [_vehicle] spawn life_fnc_lqbcynvuzmyiovvqkbpqmjxtlgkusosajeksdxvjmnbwexsgwxvwcfygo; _vehicle addBackpackCargoGlobal ["B_FieldPack_cbr",1]; if(_vehicle isKindOf "Plane") then {_vehicle addBackpackCargoGlobal ["B_Parachute",8];}; _vehicle addItemCargoGlobal ["Toolkit",if(perk_11 < 1) then {1} else {2}]; true; 