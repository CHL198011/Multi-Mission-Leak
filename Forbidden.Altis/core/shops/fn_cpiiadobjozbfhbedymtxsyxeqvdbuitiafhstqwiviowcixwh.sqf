
#include <macro.h>
 private["_type","_index","_price","_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj","_name","_xstdcwblccotsinntssxhenllmjyzszhxnyfpdqwntpznqyagpsiorgfjfggtgz"]; if(EQUAL(lbCurSel 2402,-1)) exitWith {}; _type = lbData[2402,(lbCurSel 2402)];  _price = 0.0; _itemNameToSearchFor = _type; { 	_curItemName = _x select 0; 	_curItemPrice = _x select 1; 	if (_curItemName==_itemNameToSearchFor) then {_price=_curItemPrice}; } forEach DYNMARKET_prices;  if(EQUAL(_price,-1)) exitWith {}; if(isNil "life_soldItemsLog") then {life_soldItemsLog = [];};  _dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj = ctrlText 2405; if(!([_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj] call TON_fnc_isnumber)) exitWith {hint localize "STR_Shop_Virt_NoNum";}; _dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj = parseNumber (_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj); if(_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj > (ITEM_VALUE(_type))) exitWith {hint localize "STR_Shop_Virt_NotEnough"}; if(playerSide != civilian && _type == "goldbar") exitWith {hint localize "STR_m_CopNotSell";};  _price = (_price * _dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj); _name = M_CONFIG(getText,"VirtualItems",_type,"displayName"); if(([false,_type,_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj] call life_fnc_obfjrnynfhghcglhujcjbgakxemxpjvrqczgxoeickhzvgovmtdbvr)) then { 	if(life_shop_npc == high_risk) then {_price = round (_price * 1.15)}; 	ADD(CASH,_price); 	[4,localize (ITEM_NAME(_type)),(getPlayerUID player),false,[],[],_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj] remoteExec ["TON_fnc_biccwmelxtllyqsrgknditylbnatpufhkgtqkjtdchpuczoxztizsmr",2]; 	if(_type == "oil_processed") then {[_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj * 40] remoteExec ["TON_fnc_sicuhaqqmugqvzvptsbzxseykwedckckcnbbdiipupalpqzgphrtsaegq",2]; systemChat format[localize "STR_m_IncreasedOilBank",(_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj * 40)];}; 	 	if(isNil "PLD_earnedSync") then {PLD_earnedSync = 0;}; 	PLD_earnedSync = PLD_earnedSync + _price; 	if(!((localize _name) in life_soldItemsLog)) then { 		life_soldItemsLog pushBack (localize _name); 	}; 	 	[] spawn { 		if(isNil "PLD_inProgress") then {PLD_inProgress = false;}; 		if(PLD_inProgress) exitWith {}; 		PLD_inProgress = true; 		 		sleep 120; 		 		switch (call life_donatorlvl) do { 			case 5: {PLD_earned = round (PLD_earnedSync/5000);}; 			case 4: {PLD_earned = round (PLD_earnedSync/5000);}; 			case 3: {PLD_earned = round (PLD_earnedSync/5000);}; 			case 2: {PLD_earned = round (PLD_earnedSync/7500);}; 			default {PLD_earned = round (PLD_earnedSync/10000);}; 		}; 		 		if(PLD_earned > 0) then { 			if((call life_donatorlvl) > 0 && (perk_2 >= 1)) then { 				[getPlayerUID player,PLD_earned] remoteExec ["DB_fnc_oonvaewfbpctdobtaxtslcwjpahbederwnzozlriwmhsukolulryozbcbraw",2]; 				[2,format[localize "STR_m_PLDsynced",PLD_earned]] call life_fnc_broadcast; 			}; 			 		}; 		 		PLD_earnedSync = 0; 		PLD_inProgress = false; 		life_soldItemsLog = []; 	}; 	 	 	 	switch (true) do { 		case (((call life_donatorlvl) > 0) && (perk_2 >= 1)): { 			hint format[localize "STR_Shop_Virt_SellItem2",_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj,(localize _name),[_price] call life_fnc_ccxpkhrsgzfibqpgmuxgqovtqnwczbibnrrxqvyckzrmhckzyugqq,if(life_shop_npc == high_risk) then {" (15% extra pga hög risk)"} else {""}]; 		}; 		case (perk_2 >= 1): { 			hint format[localize "STR_Shop_Virt_SellItem",_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj,(localize _name),[_price] call life_fnc_ccxpkhrsgzfibqpgmuxgqovtqnwczbibnrrxqvyckzrmhckzyugqq,if(life_shop_npc == high_risk) then {" (15% extra pga hög risk)"} else {""}]; 		}; 		default { 			hint format[localize "STR_Shop_Virt_SellItem3",_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj,(localize _name),[_price] call life_fnc_ccxpkhrsgzfibqpgmuxgqovtqnwczbibnrrxqvyckzrmhckzyugqq,localize ([2] call life_fnc_qokbfvuujyauzhpwhhtwfwakspbzosfzvnzazblmmcrbpdqwwbfdbdztgoic),if(life_shop_npc == high_risk) then {" (15% extra pga hög risk)"} else {""}]; 		}; 	}; 	 	[] call life_fnc_gkwnkgzsbctffywgfgpbmajtsysegtxuzzmismumlztegoeubohrgnimskcx; 	DYNAMICMARKET_boughtItems pushBack [_type,_dcefxvunjgbgostmlyiqbnewihxwgxbwtmrnfuybixwpxmfnzylooimsqdzeizqmcj]; };   if(EQUAL(life_shop_type,"drugdealer")) then { 	private["_csaeypuwhorilskepxbreprlchbkldayfsfwshrvvhvhpqrgxgasiajnodrrs","_ind","_val"]; 	_csaeypuwhorilskepxbreprlchbkldayfsfwshrvvhvhpqrgxgasiajnodrrs = life_shop_npc getVariable["sellers",[]]; 	_ind = [getPlayerUID player,_csaeypuwhorilskepxbreprlchbkldayfsfwshrvvhvhpqrgxgasiajnodrrs] call TON_fnc_index; 	if(!(EQUAL(_ind,-1))) then { 		_val = SEL(SEL(_csaeypuwhorilskepxbreprlchbkldayfsfwshrvvhvhpqrgxgasiajnodrrs,_ind),2); 		ADD(_val,_price); 		_csaeypuwhorilskepxbreprlchbkldayfsfwshrvvhvhpqrgxgasiajnodrrs set[_ind,[getPlayerUID player,profileName,_val,player]]; 		life_shop_npc setVariable["sellers",_csaeypuwhorilskepxbreprlchbkldayfsfwshrvvhvhpqrgxgasiajnodrrs,true]; 	} else { 		_csaeypuwhorilskepxbreprlchbkldayfsfwshrvvhvhpqrgxgasiajnodrrs pushBack [getPlayerUID player,profileName,_price,player]; 		life_shop_npc setVariable["sellers",_csaeypuwhorilskepxbreprlchbkldayfsfwshrvvhvhpqrgxgasiajnodrrs,true]; 	}; };  [3] call SOCK_fnc_ddjmbrftntgdwpptfaoymlxkcjyscjwhklmcfylqhrqrxtxznnh; [0] call SOCK_fnc_ddjmbrftntgdwpptfaoymlxkcjyscjwhklmcfylqhrqrxtxznnh;  { 	detach _x; } foreach nearestObjects [getPos player,"",50]; 