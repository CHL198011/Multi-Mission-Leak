
#include <macro.h>
 private["_markers","_umblgefmlovczxbndvsnzreyucsnozkijsuogurziwrhsikirhkkrqiercsfhmrlalh","_oiqkdioguzolmauetciqrijyarwsjcbwdwhfwiilflfcexotmnqtlzytxvworpzkbak","_nsixgnbeimrjvskgoltiihpltwrqabbgotzvozsmnueemcfewsbyqjdyxvvifo"]; _markers = []; _umblgefmlovczxbndvsnzreyucsnozkijsuogurziwrhsikirhkkrqiercsfhmrlalh = [];  if(isNil "medicLoop_running") then {medicLoop_running = false;}; if(isNil "deadmarkers_refresh") then {deadmarkers_refresh = false;}; if(isNil "deadPlayers") then {deadPlayers = [];}; if(isNil "requestedPlayers") then {requestedPlayers = [];};   sleep 0.5; if(visibleMap) then { 	if((playerSide == independent OR life_markers) && !medicLoop_running && !deadmarkers_refresh) then { 		[] spawn { 			private ["_omfqpirzhdmrkbwjhkyeizrfgniyydsrqkgkrvvcvskyonauqxdgfnqyyybyt","_bitkzxnkktqozqkbhekqlcsqducqzmmdvfdtptrbanhyavshxwlvrrwqtjvrlhcug","_oiqkdioguzolmauetciqrijyarwsjcbwdwhfwiilflfcexotmnqtlzytxvworpzkbak","_marker","_nsixgnbeimrjvskgoltiihpltwrqabbgotzvozsmnueemcfewsbyqjdyxvvifo","_nsixgnbeimrjvskgoltiihpltwrqabbgotzvozsmnueemcfewsbyqjdyxvvifoMarkers","_tfredlvkqemxnvzyztlugesjzgoukgqorilsftlbrojuhgsjdqnsprmioasqqeijvdwmva"]; 			_oiqkdioguzolmauetciqrijyarwsjcbwdwhfwiilflfcexotmnqtlzytxvworpzkbak = []; 			deadPlayers = []; 			requestedPlayers = []; 			medicMarkers_initialized = false; 			 			 			while {visibleMap && (playerSide == independent OR life_markers)} do { 				medicLoop_running = true; 				deadmarkers_refresh = false; 				{ 					_omfqpirzhdmrkbwjhkyeizrfgniyydsrqkgkrvvcvskyonauqxdgfnqyyybyt = _x getVariable "name"; 					_bitkzxnkktqozqkbhekqlcsqducqzmmdvfdtptrbanhyavshxwlvrrwqtjvrlhcug = _x getVariable ["Revive",false]; 					if(!isNil "_omfqpirzhdmrkbwjhkyeizrfgniyydsrqkgkrvvcvskyonauqxdgfnqyyybyt" && !_bitkzxnkktqozqkbhekqlcsqducqzmmdvfdtptrbanhyavshxwlvrrwqtjvrlhcug && !(_x getVariable ["owner_offline",false])) then { 						_oiqkdioguzolmauetciqrijyarwsjcbwdwhfwiilflfcexotmnqtlzytxvworpzkbak pushBack _x; 					}; 				} foreach allDeadMen; 				 				{ 					_marker = createMarkerLocal [format["dead_marker_%1",_x],visiblePosition _x]; 					_nsixgnbeimrjvskgoltiihpltwrqabbgotzvozsmnueemcfewsbyqjdyxvvifo = _x getVariable ["RequestedMedic",false]; 					_tfredlvkqemxnvzyztlugesjzgoukgqorilsftlbrojuhgsjdqnsprmioasqqeijvdwmva = _x getVariable ["MedicPriority",false]; 					 					 					 					 					 					 					 					 					if(_x getVariable ["ress_disabled",false]) then { 						_marker setMarkerTypeLocal "KIA"; 						_marker setMarkerColorLocal "ColorBlack"; 					} else { 						_marker setMarkerTypeLocal "loc_Hospital"; 						if(_nsixgnbeimrjvskgoltiihpltwrqabbgotzvozsmnueemcfewsbyqjdyxvvifo) then { 							requestedPlayers pushBack _x; 							[_marker,_tfredlvkqemxnvzyztlugesjzgoukgqorilsftlbrojuhgsjdqnsprmioasqqeijvdwmva] spawn { 								while {!deadmarkers_refresh} do { 									(_this select 0) setMarkerColorLocal "ColorGreen"; 									sleep 0.5; 									if(visibleMap && !deadmarkers_refresh) then { 										if(_this select 1) then { 											(_this select 0) setMarkerColorLocal "ColorOrange"; 										} else { 											(_this select 0) setMarkerColorLocal "ColorRed"; 										}; 										sleep 0.5; 									}; 								}; 							}; 						} else { 							_marker setMarkerColorLocal "ColorRed"; 						}; 					}; 					 					 					_marker setMarkerTextLocal format["%2%1",(_x getVariable["name","Unknown Player"]),if(_tfredlvkqemxnvzyztlugesjzgoukgqorilsftlbrojuhgsjdqnsprmioasqqeijvdwmva) then {"PRIO: "} else {""}]; 					deadPlayers pushBack _x; 				} foreach _oiqkdioguzolmauetciqrijyarwsjcbwdwhfwiilflfcexotmnqtlzytxvworpzkbak; 				medicMarkers_initialized = true; 				 				waitUntil {!visibleMap OR deadmarkers_refresh OR !(life_markers OR playerSide == independent)}; 				if(deadmarkers_refresh) then {sleep 1; deadmarkers_refresh = false;}; 				 				{deleteMarkerLocal format["dead_marker_%1",_x];} foreach deadPlayers; 				deadPlayers = []; 				requestedPlayers = []; 				_oiqkdioguzolmauetciqrijyarwsjcbwdwhfwiilflfcexotmnqtlzytxvworpzkbak = []; 				medicLoop_running = false; 			}; 		}; 		 		[] spawn { 			private ["_marker","_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie"]; 			waitUntil {medicMarkers_initialized OR !(playerSide == independent OR life_markers)}; 			while {visibleMap && medicLoop_running} do { 				if(!deadmarkers_refresh) then { 					{ 						_omfqpirzhdmrkbwjhkyeizrfgniyydsrqkgkrvvcvskyonauqxdgfnqyyybyt = _x getVariable "name"; 						_bitkzxnkktqozqkbhekqlcsqducqzmmdvfdtptrbanhyavshxwlvrrwqtjvrlhcug = _x getVariable ["Revive",false]; 						if(!isNil "_omfqpirzhdmrkbwjhkyeizrfgniyydsrqkgkrvvcvskyonauqxdgfnqyyybyt" && !_bitkzxnkktqozqkbhekqlcsqducqzmmdvfdtptrbanhyavshxwlvrrwqtjvrlhcug && !(_x getVariable ["owner_offline",false]) && !(_x in deadPlayers)) exitWith { 							deadmarkers_refresh = true; 						}; 					} foreach allDeadMen; 					 					{ 						if(deadmarkers_refresh) exitWith {}; 						_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie = _x; 						 						if(isNull _wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie) exitWith {deadmarkers_refresh = true;}; 						if(alive _wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie) exitWith {deadmarkers_refresh = true;}; 						if(_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie getVariable ["owner_offline",false]) exitWith {deadmarkers_refresh = true;}; 						if(_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie getVariable ["Revive",true]) exitWith {deadmarkers_refresh = true;}; 						if((_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie getVariable ["RequestedMedic",false]) && !(_x in requestedPlayers) && !(_x getVariable ["ress_disabled",false])) exitWith {deadmarkers_refresh = true;}; 						if((_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie getVariable ["ress_disabled",false]) && (getMarkerColor format["dead_marker_%1",_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie] != "ColorBlack")) exitWith {deadmarkers_refresh = true;}; 						if(!(_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie getVariable ["ress_disabled",false]) && (getMarkerColor format["dead_marker_%1",_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie] == "ColorBlack")) exitWith {deadmarkers_refresh = true;}; 					} foreach deadPlayers; 				}; 				sleep 0.2; 			}; 		 		}; 	};  	_umblgefmlovczxbndvsnzreyucsnozkijsuogurziwrhsikirhkkrqiercsfhmrlalh = units grpPlayer; 	{ 		_marker = createMarkerLocal [format["%1_marker",_x],visiblePosition _x]; 		_marker setMarkerColorLocal "ColorBlue"; 		_marker setMarkerTypeLocal "Mil_dot"; 		_marker setMarkerTextLocal format["%1", name _x]; 		_markers set[count _markers,[_marker,_x]]; 	} foreach _umblgefmlovczxbndvsnzreyucsnozkijsuogurziwrhsikirhkkrqiercsfhmrlalh; 	 	while {visibleMap} do { 		{ 			private["_marker","_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie"]; 			_marker = _x select 0; 			_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie = _x select 1; 			if(!isNil "_wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie") then { 				if(!isNull _wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie) then { 					_marker setMarkerPosLocal (visiblePosition _wcpgicsvsxavoanjoucrwsjlijdcxhswxxdlkokjskpevefglffpjrnseayiyxxvzjie); 				}; 			}; 		} foreach _markers; 		if(!visibleMap) exitWith {}; 		sleep 0.02; 	};  	 	{deleteMarkerLocal (_x select 0);} foreach _markers; 	_markers = []; 	_umblgefmlovczxbndvsnzreyucsnozkijsuogurziwrhsikirhkkrqiercsfhmrlalh = []; }; 